Core domain model (this is the spine of everything)
2.1 Users (admins only)
User
- id
- name
- email
- role (admin | super_admin)
- is_active
- created_at

2.2 Reference tables (admin-managed)

These NEVER store free text on clients.

County
- id
- name
- is_active

ServiceType
- id
- name (GRH, HWS-I, LTH, etc)
- is_active

ServiceStatus
- id
- name (Active, Inactive, Removed)

PaymentMethod
- id
- name

ExpenseCategory
- id
- name

2.3 Client (core identity)
Client
- id
- full_name
- phone
- county_case_number
- county_id (FK)
- service_type_id (FK)
- service_status_id (FK)
- is_active
- created_at

IMPORTANT

When a client changes county or service type:

You update the FK

You write a history record

You audit the change

2.4 Client history (for corrections over time)
ClientHistory
- id
- client_id
- field_changed
- old_value
- new_value
- changed_by (user_id)
- changed_at

2.5 Housing & landlord details
ClientHousing
- id
- client_id
- address
- landlord_name
- landlord_phone
- landlord_address

2.6 Documents (file-based, auditable)
ClientDocument
- id
- client_id
- document_type (HS_AWARD, LEASE, POLICY, OTHER)
- file_url
- uploaded_by
- uploaded_at

3. Financial model (this is the most important part)

Everything is month-scoped and year-scoped.

3.1 Monthly financial header
ClientMonth
- id
- client_id
- year (2025, 2026)
- month (1–12)
- is_locked (true after 30 days unless super_admin)


This acts as a container for that month.

3.2 Housing Support (1 per month)
HousingSupport
- id
- client_month_id
- amount
- received_date
- created_by
- created_at

3.3 Rent (1 per month)
RentPayment
- id
- client_month_id
- expected_amount
- paid_amount
- paid_date
- is_confirmed

3.4 LTH (many per month)
LTHPayment
- id
- client_month_id
- amount
- received_date

3.5 Expenses (many per month)
Expense
- id
- client_month_id
- category_id
- amount
- expense_date
- notes

3.6 Pool fund (derived but stored)
PoolFund
- id
- client_month_id
- hs_amount
- rent_amount
- expense_amount
- pool_amount (can be negative)
- calculated_at

Pool fund formula
pool_amount =
HS
- (Rent Paid + Total Expenses)


Negative values are allowed and visible.

4. Audit & activity tracking (non-negotiable)
4.1 Audit log (raw, immutable)
AuditLog
- id
- user_id
- action_type
- entity
- entity_id
- old_data (JSON)
- new_data (JSON)
- created_at

4.2 Activity feed (human readable)
Activity
- id
- message
- related_client_id (nullable)
- created_at


Example:

“Admin Jane updated HS for 14 clients in Hennepin County – March 2026”

5. Permissions & locking rules
Edit window logic

Records editable until 30 days after month end

After that:

❌ admin blocked

✅ super_admin allowed

ClientMonth.is_locked enforces this